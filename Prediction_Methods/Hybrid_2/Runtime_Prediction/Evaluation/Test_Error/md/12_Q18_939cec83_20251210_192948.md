# Query Prediction Report (Hybrid_2)

**Query:** Q18_104_seed_845015193
**Timestamp:** 2025-12-10 19:29:48

## Pattern Assignments

**Total Patterns Matched:** 5

| Root Node | Pattern Hash | Pattern String |
|-----------|--------------|----------------|
| 28884 | 0aa5463f1b91... | Limit -> Sort -> Aggregate -> Gather Merge -> Incremental Sort -> Nested Loop -> [Merge Join (Outer), Index Scan (Inner)] (Outer) (Outer) (Outer) (Outer) (Outer) |
| 28885 | 1d35fb978b37... | Sort -> Aggregate (Outer) |
| 28887 | 0564d0b3361e... | Gather Merge -> Incremental Sort -> Nested Loop -> [Merge Join -> [Sort -> Hash Join -> [Seq Scan (Outer), Hash -> Aggregate (Outer) (Inner)] (Outer) (Outer), Sort -> Seq Scan (Outer) (Inner)] (Outer), Index Scan (Inner)] (Outer) (Outer) |
| 28889 | 4b856d44f421... | Nested Loop -> [Merge Join (Outer), Index Scan (Inner)] |
| 28891 | 3e2d5a00246f... | Sort -> Hash Join (Outer) |

## Query Tree

```
Node 28884 (Limit) [PATTERN ROOT] - ROOT
  Node 28885 (Sort) [PATTERN ROOT]
    Node 28886 (Aggregate) [consumed]
      Node 28887 (Gather Merge) [PATTERN ROOT]
        Node 28888 (Incremental Sort) [consumed]
          Node 28889 (Nested Loop) [PATTERN ROOT]
            Node 28890 (Merge Join) [consumed]
              Node 28891 (Sort) [PATTERN ROOT]
                Node 28892 (Hash Join) [consumed]
                  Node 28893 (Seq Scan) [consumed]
                  Node 28894 (Hash) [consumed]
                    Node 28895 (Aggregate) [consumed]
                      Node 28896 (Index Scan)
              Node 28897 (Sort) [consumed]
                Node 28898 (Seq Scan) [consumed]
            Node 28899 (Index Scan) [consumed]
```

## Prediction Chain (Bottom-Up)

### Step 1 (depth 11): Operator Fallback

- **Node:** 28896 (Index Scan)
- **Reason:** No pattern match
- **Output:** st=0.08, rt=0.03

### Step 2 (depth 7): Pattern Match

- **Pattern:** Sort -> Hash Join (Outer)
- **Hash:** 3e2d5a00246ff56483c16003698d4917
- **Root:** Node 28891 (Sort)
- **Consumed Children:** Node 28892 (Hash Join)
- **Output:** st=1324.29, rt=1324.32

### Step 3 (depth 5): Pattern Match

- **Pattern:** Nested Loop -> [Merge Join (Outer), Index Scan (Inner)]
- **Hash:** 4b856d44f421312792e2ac1665cc79be
- **Root:** Node 28889 (Nested Loop)
- **Consumed Children:** Node 28890 (Merge Join), Node 28899 (Index Scan)
- **Output:** st=2906.68, rt=2908.72

### Step 4 (depth 3): Pattern Match

- **Pattern:** Gather Merge -> Incremental Sort -> Nested Loop -> [Merge Join -> [Sort -> Hash Join -> [Seq Scan (Outer), Hash -> Aggregate (Outer) (Inner)] (Outer) (Outer), Sort -> Seq Scan (Outer) (Inner)] (Outer), Index Scan (Inner)] (Outer) (Outer)
- **Hash:** 0564d0b3361e670c2e404e29c4e1752c
- **Root:** Node 28887 (Gather Merge)
- **Consumed Children:** Node 28888 (Incremental Sort), Node 28889 (Nested Loop), Node 28890 (Merge Join), Node 28891 (Sort), Node 28892 (Hash Join), Node 28893 (Seq Scan), Node 28894 (Hash), Node 28895 (Aggregate), Node 28897 (Sort), Node 28898 (Seq Scan), Node 28899 (Index Scan)
- **Output:** st=2927.65, rt=2934.73

### Step 5 (depth 1): Pattern Match

- **Pattern:** Sort -> Aggregate (Outer)
- **Hash:** 1d35fb978b379d4a820897907e56ab7b
- **Root:** Node 28885 (Sort)
- **Consumed Children:** Node 28886 (Aggregate)
- **Output:** st=1380.70, rt=1382.42

### Step 6 (depth 0): Pattern Match

- **Pattern:** Limit -> Sort -> Aggregate -> Gather Merge -> Incremental Sort -> Nested Loop -> [Merge Join (Outer), Index Scan (Inner)] (Outer) (Outer) (Outer) (Outer) (Outer)
- **Hash:** 0aa5463f1b91f165f60e8a19a4979344
- **Root:** Node 28884 (Limit)
- **Consumed Children:** Node 28885 (Sort), Node 28886 (Aggregate), Node 28887 (Gather Merge), Node 28888 (Incremental Sort), Node 28889 (Nested Loop), Node 28890 (Merge Join), Node 28899 (Index Scan)
- **Output:** st=3044.70, rt=3051.15

## Prediction Results

| Node | Type | Depth | Pred Type | Actual RT | Pred RT | MRE (%) |
|------|------|-------|-----------|-----------|---------|---------|
| 28884 | Limit | 0 | pattern | 3069.47 | 3051.15 | 0.6 |
| 28885 | Sort | 1 | pattern | 2950.93 | 1382.42 | 53.2 |
| 28887 | Gather Merge | 3 | pattern | 2950.88 | 2934.73 | 0.5 |
| 28889 | Nested Loop | 5 | pattern | 2931.43 | 2908.72 | 0.8 |
| 28891 | Sort | 7 | pattern | 2860.45 | 1324.32 | 53.7 |
| 28896 | Index Scan | 11 | operator | 2124.96 | 0.03 | 100.0 |
