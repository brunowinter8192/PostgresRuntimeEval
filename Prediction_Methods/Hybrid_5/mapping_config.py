#!/usr/bin/env python3

# INFRASTRUCTURE

# Pattern hash IDs extracted from Data_Generation/csv/01_patterns_*.csv
# All patterns with > 120 occurrences, lengths 2-9
# Total: 72 patterns
PATTERNS = [
    '895c6e8c1a30a094329d71cef3111fbd',
    '3aab37bea1a884da206eb32f2c1ae5ba',
    '1d35fb978b379d4a820897907e56ab7b',
    '7df893ad48ca148008fc536ad76ff48a',
    '2724c08067c017e6455632f46231780c',
    '4fc84c77ced18a46514c982f23f12deb',
    '2e0f44eff91c745724a56159cf7e0d6f',
    '3cfa90d7df3cd40936e985146fc5ec76',
    '1691f6f0dbbde049f7f6b5d065d62f74',
    'c53c43965386239f53c764b9a60720dd',
    '634cdbe24fda21720ccd3dc746d5c979',
    '3e2d5a00246ff56483c16003698d4917',
    '7524c54c59c38d4c931870520c264f63',
    'e296a71f830144e9c017d1502a6dcc01',
    '184f44dea835017982d512c08043f20c',
    '7d4e78be851232c5a0cc7a0cf9df4593',
    '46f37744a683caa98c7864be249e8d71',
    '3754655cfe1a94f82fbddab4e376c57d',
    '3b44787560c64172b4501d3cae04fd1b',
    'f4cb205adfd108034c883c87871a6da8',
    'bb9308256700fc12e4125487e887832e',
    'c0a8d3deb0fdb169e0a08bb071cd8160',
    'e0e3c3e1b229568ff01695a42f46d8ea',
    '29ee00dbeea63ba27a7d0fe66bc67b49',
    'a5f39f08c510532e02e96e109e48c0cd',
    '422ae017fa27104671904e4f61703f9d',
    '7bcfec2259bf8f077d86cc017740ebd6',
    'b3a4509347209a6fe95e44fff8ff3908',
    '91d6e559a346986650c19e953502114b',
    '2422d11162cb474bacd9ebfa0bc68bb2',
    '2e8f3f675d9e1253d227c0b1edebeefb',
    '715d5c92d04e9fdd3e607001ad32ee57',
    '30d6e09bdb501c499cb36578168e324f',
    '2873b8c3a1759afe345ffbdfc9bdcba7',
    '8a8c43c6e5296c8252f967d740368fb6',
    'e6c1e0d80e32f1143d09cc88a08370bd',
    'ddb1e0cae6d1724880dfc741b2555585',
    '98d4ff98a85ecf333b0de5d4f060d098',
    '37515ad868a103fed23cf07c65b8a248',
    'a54055cece1adb617abae41ca3244142',
    'bd9dfa7bb8f3b0473cdfb5cd4277dc3a',
    'efde8b387936f6dfa72a80ba94a03a08',
    'af27a52b75459a4f4068970057686d71',
    '444761fbda0298231751710dd8593e72',
    'f8231c4dd4c57d8a84a6ba0a53bdb42d',
    '25df29b5b69835d07c0d8b72b0e46a3b',
    '7a51ce50a8f4529f944f9df797fa04b8',
    '460af52cdecd0ba229546017c25fee3b',
    '4e54d6840808c7462fac1fcda97b3d9b',
    '12e6457cd65bdff467be29a8e3d0b807',
    '4db0722060ee43c47566ae44a34d98aa',
    'b149ff282ebc2d2b2e199afbf6e167c9',
    '3c6d80067ee1c8bfc0ff6ec2ffb502e3',
    '9d0e407c0aa5052a4246612a4a2e0ad2',
    '545b5e576c5930d559d8e42d610637d8',
    '310134da512a875c467ef0794352611a',
    'ec92bdaa27b47a2a45a6787f34350878',
    '422b9b8c0f34b5a74aeec7b834afb9ea',
    '440e6274a192d28a59f1aa9e2963c5a5',
    '314469b03cc9f414eec95f78c85c73f5',
    '53f9aa07d73657d04951f9bbdd83fef8',
    'f8295d8b477b477dfdc9391679ee0626',
    'f4603221ed908983d5775a3734bacac0',
    '5bfce15946616546d0be06b28c79e909',
    'e1d7e5b4b64fa2791f32be783ffb6013',
    '54cb7f90c390f02e0b015342853386d0',
    '3d4c3db9a0977643bddc82d44c93492c',
    'ef93d4fc6e5b9506d1cf51950a1c2be7',
    'c302739ba5fe522ac572bfdbdd8c26e9',
    '9ce781b0006e0486de27d9cf912f5f3b',
    '5ae97df8a6895acd1a7e15f6e5b6f95f',
    'a95bee4e9ae59bc7fb7a48a1a7973a31'
]

# Operator count per pattern (number of nodes in pattern structure)
# Calculated from Datasets/Baseline/<hash>/training.csv using formula: actual_rows / occurrence_count
PATTERN_OPERATOR_COUNT = {
    '895c6e8c1a30a094329d71cef3111fbd': 3,
    '3aab37bea1a884da206eb32f2c1ae5ba': 2,
    '1d35fb978b379d4a820897907e56ab7b': 2,
    '7df893ad48ca148008fc536ad76ff48a': 2,
    '2724c08067c017e6455632f46231780c': 2,
    '4fc84c77ced18a46514c982f23f12deb': 2,
    '2e0f44eff91c745724a56159cf7e0d6f': 3,
    '3cfa90d7df3cd40936e985146fc5ec76': 3,
    '1691f6f0dbbde049f7f6b5d065d62f74': 2,
    'c53c43965386239f53c764b9a60720dd': 3,
    '634cdbe24fda21720ccd3dc746d5c979': 2,
    '3e2d5a00246ff56483c16003698d4917': 2,
    '7524c54c59c38d4c931870520c264f63': 2,
    'e296a71f830144e9c017d1502a6dcc01': 2,
    '184f44dea835017982d512c08043f20c': 2,
    '7d4e78be851232c5a0cc7a0cf9df4593': 3,
    '46f37744a683caa98c7864be249e8d71': 2,
    '3754655cfe1a94f82fbddab4e376c57d': 2,
    '3b44787560c64172b4501d3cae04fd1b': 2,
    'f4cb205adfd108034c883c87871a6da8': 4,
    'bb9308256700fc12e4125487e887832e': 4,
    'c0a8d3deb0fdb169e0a08bb071cd8160': 4,
    'e0e3c3e1b229568ff01695a42f46d8ea': 5,
    '29ee00dbeea63ba27a7d0fe66bc67b49': 3,
    'a5f39f08c510532e02e96e109e48c0cd': 3,
    '422ae017fa27104671904e4f61703f9d': 4,
    '7bcfec2259bf8f077d86cc017740ebd6': 3,
    'b3a4509347209a6fe95e44fff8ff3908': 3,
    '91d6e559a346986650c19e953502114b': 4,
    '2422d11162cb474bacd9ebfa0bc68bb2': 6,
    '2e8f3f675d9e1253d227c0b1edebeefb': 3,
    '715d5c92d04e9fdd3e607001ad32ee57': 3,
    '30d6e09bdb501c499cb36578168e324f': 6,
    '2873b8c3a1759afe345ffbdfc9bdcba7': 6,
    '8a8c43c6e5296c8252f967d740368fb6': 3,
    'e6c1e0d80e32f1143d09cc88a08370bd': 3,
    'ddb1e0cae6d1724880dfc741b2555585': 3,
    '98d4ff98a85ecf333b0de5d4f060d098': 3,
    '37515ad868a103fed23cf07c65b8a248': 6,
    'a54055cece1adb617abae41ca3244142': 5,
    'bd9dfa7bb8f3b0473cdfb5cd4277dc3a': 6,
    'efde8b387936f6dfa72a80ba94a03a08': 4,
    'af27a52b75459a4f4068970057686d71': 5,
    '444761fbda0298231751710dd8593e72': 5,
    'f8231c4dd4c57d8a84a6ba0a53bdb42d': 4,
    '25df29b5b69835d07c0d8b72b0e46a3b': 4,
    '7a51ce50a8f4529f944f9df797fa04b8': 9,
    '460af52cdecd0ba229546017c25fee3b': 4,
    '4e54d6840808c7462fac1fcda97b3d9b': 5,
    '12e6457cd65bdff467be29a8e3d0b807': 7,
    '4db0722060ee43c47566ae44a34d98aa': 8,
    'b149ff282ebc2d2b2e199afbf6e167c9': 4,
    '3c6d80067ee1c8bfc0ff6ec2ffb502e3': 5,
    '9d0e407c0aa5052a4246612a4a2e0ad2': 8,
    '545b5e576c5930d559d8e42d610637d8': 7,
    '310134da512a875c467ef0794352611a': 6,
    'ec92bdaa27b47a2a45a6787f34350878': 7,
    '422b9b8c0f34b5a74aeec7b834afb9ea': 6,
    '440e6274a192d28a59f1aa9e2963c5a5': 9,
    '314469b03cc9f414eec95f78c85c73f5': 7,
    '53f9aa07d73657d04951f9bbdd83fef8': 6,
    'f8295d8b477b477dfdc9391679ee0626': 7,
    'f4603221ed908983d5775a3734bacac0': 11,
    '5bfce15946616546d0be06b28c79e909': 9,
    'e1d7e5b4b64fa2791f32be783ffb6013': 9,
    '54cb7f90c390f02e0b015342853386d0': 8,
    '3d4c3db9a0977643bddc82d44c93492c': 12,
    'ef93d4fc6e5b9506d1cf51950a1c2be7': 11,
    'c302739ba5fe522ac572bfdbdd8c26e9': 10,
    '9ce781b0006e0486de27d9cf912f5f3b': 14,
    '5ae97df8a6895acd1a7e15f6e5b6f95f': 12,
    'a95bee4e9ae59bc7fb7a48a1a7973a31': 15
}
# Pattern leaf timing features to retain during cleaning
# Generated from Data_Generation/csv/02_pattern_leafs_*.csv
# Format: {hash: [list of timing feature column names]}
PATTERN_LEAF_TIMING_FEATURES = {
    '895c6e8c1a30a094329d71cef3111fbd': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '3aab37bea1a884da206eb32f2c1ae5ba': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '1d35fb978b379d4a820897907e56ab7b': ['Aggregate_Outer_st1', 'Aggregate_Outer_rt1', 'Aggregate_Outer_st2', 'Aggregate_Outer_rt2'],
    '7df893ad48ca148008fc536ad76ff48a': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2'],
    '2724c08067c017e6455632f46231780c': ['GatherMerge_Outer_st1', 'GatherMerge_Outer_rt1', 'GatherMerge_Outer_st2', 'GatherMerge_Outer_rt2'],
    '4fc84c77ced18a46514c982f23f12deb': ['Gather_Outer_st1', 'Gather_Outer_rt1', 'Gather_Outer_st2', 'Gather_Outer_rt2'],
    '2e0f44eff91c745724a56159cf7e0d6f': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'NestedLoop_Outer_st1', 'NestedLoop_Outer_rt1', 'NestedLoop_Outer_st2', 'NestedLoop_Outer_rt2'],
    '3cfa90d7df3cd40936e985146fc5ec76': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2'],
    '1691f6f0dbbde049f7f6b5d065d62f74': ['Sort_Outer_st1', 'Sort_Outer_rt1', 'Sort_Outer_st2', 'Sort_Outer_rt2'],
    'c53c43965386239f53c764b9a60720dd': ['IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '634cdbe24fda21720ccd3dc746d5c979': ['Aggregate_Outer_st1', 'Aggregate_Outer_rt1', 'Aggregate_Outer_st2', 'Aggregate_Outer_rt2'],
    '3e2d5a00246ff56483c16003698d4917': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2'],
    '7524c54c59c38d4c931870520c264f63': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2'],
    'e296a71f830144e9c017d1502a6dcc01': ['Sort_Outer_st1', 'Sort_Outer_rt1', 'Sort_Outer_st2', 'Sort_Outer_rt2'],
    '184f44dea835017982d512c08043f20c': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '7d4e78be851232c5a0cc7a0cf9df4593': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2'],
    '46f37744a683caa98c7864be249e8d71': ['Aggregate_Outer_st1', 'Aggregate_Outer_rt1', 'Aggregate_Outer_st2', 'Aggregate_Outer_rt2'],
    '3754655cfe1a94f82fbddab4e376c57d': ['Sort_Outer_st1', 'Sort_Outer_rt1', 'Sort_Outer_st2', 'Sort_Outer_rt2'],
    '3b44787560c64172b4501d3cae04fd1b': ['NestedLoop_Outer_st1', 'NestedLoop_Outer_rt1', 'NestedLoop_Outer_st2', 'NestedLoop_Outer_rt2'],
    'f4cb205adfd108034c883c87871a6da8': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'bb9308256700fc12e4125487e887832e': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'c0a8d3deb0fdb169e0a08bb071cd8160': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'e0e3c3e1b229568ff01695a42f46d8ea': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '29ee00dbeea63ba27a7d0fe66bc67b49': ['Sort_Outer_st1', 'Sort_Outer_rt1', 'Sort_Outer_st2', 'Sort_Outer_rt2'],
    'a5f39f08c510532e02e96e109e48c0cd': ['Aggregate_Outer_st1', 'Aggregate_Outer_rt1', 'Aggregate_Outer_st2', 'Aggregate_Outer_rt2'],
    '422ae017fa27104671904e4f61703f9d': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '7bcfec2259bf8f077d86cc017740ebd6': ['Aggregate_Outer_st1', 'Aggregate_Outer_rt1', 'Aggregate_Outer_st2', 'Aggregate_Outer_rt2'],
    'b3a4509347209a6fe95e44fff8ff3908': ['Gather_Outer_st1', 'Gather_Outer_rt1', 'Gather_Outer_st2', 'Gather_Outer_rt2'],
    '91d6e559a346986650c19e953502114b': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'NestedLoop_Outer_st1', 'NestedLoop_Outer_rt1', 'NestedLoop_Outer_st2', 'NestedLoop_Outer_rt2'],
    '2422d11162cb474bacd9ebfa0bc68bb2': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '2e8f3f675d9e1253d227c0b1edebeefb': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2'],
    '715d5c92d04e9fdd3e607001ad32ee57': ['Aggregate_Outer_st1', 'Aggregate_Outer_rt1', 'Aggregate_Outer_st2', 'Aggregate_Outer_rt2'],
    '30d6e09bdb501c499cb36578168e324f': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'NestedLoop_Outer_st1', 'NestedLoop_Outer_rt1', 'NestedLoop_Outer_st2', 'NestedLoop_Outer_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '2873b8c3a1759afe345ffbdfc9bdcba7': ['IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '8a8c43c6e5296c8252f967d740368fb6': ['Aggregate_Outer_st1', 'Aggregate_Outer_rt1', 'Aggregate_Outer_st2', 'Aggregate_Outer_rt2'],
    'e6c1e0d80e32f1143d09cc88a08370bd': ['Sort_Outer_st1', 'Sort_Outer_rt1', 'Sort_Outer_st2', 'Sort_Outer_rt2'],
    'ddb1e0cae6d1724880dfc741b2555585': ['GatherMerge_Outer_st1', 'GatherMerge_Outer_rt1', 'GatherMerge_Outer_st2', 'GatherMerge_Outer_rt2'],
    '98d4ff98a85ecf333b0de5d4f060d098': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2'],
    '37515ad868a103fed23cf07c65b8a248': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'a54055cece1adb617abae41ca3244142': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'bd9dfa7bb8f3b0473cdfb5cd4277dc3a': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'efde8b387936f6dfa72a80ba94a03a08': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2'],
    'af27a52b75459a4f4068970057686d71': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '444761fbda0298231751710dd8593e72': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'f8231c4dd4c57d8a84a6ba0a53bdb42d': ['Aggregate_Outer_st1', 'Aggregate_Outer_rt1', 'Aggregate_Outer_st2', 'Aggregate_Outer_rt2'],
    '25df29b5b69835d07c0d8b72b0e46a3b': ['Gather_Outer_st1', 'Gather_Outer_rt1', 'Gather_Outer_st2', 'Gather_Outer_rt2'],
    '7a51ce50a8f4529f944f9df797fa04b8': ['IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '460af52cdecd0ba229546017c25fee3b': ['Sort_Outer_st1', 'Sort_Outer_rt1', 'Sort_Outer_st2', 'Sort_Outer_rt2'],
    '4e54d6840808c7462fac1fcda97b3d9b': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '12e6457cd65bdff467be29a8e3d0b807': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '4db0722060ee43c47566ae44a34d98aa': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'b149ff282ebc2d2b2e199afbf6e167c9': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2'],
    '3c6d80067ee1c8bfc0ff6ec2ffb502e3': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'NestedLoop_Outer_st1', 'NestedLoop_Outer_rt1', 'NestedLoop_Outer_st2', 'NestedLoop_Outer_rt2'],
    '9d0e407c0aa5052a4246612a4a2e0ad2': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '545b5e576c5930d559d8e42d610637d8': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '310134da512a875c467ef0794352611a': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'ec92bdaa27b47a2a45a6787f34350878': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '422b9b8c0f34b5a74aeec7b834afb9ea': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '440e6274a192d28a59f1aa9e2963c5a5': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '314469b03cc9f414eec95f78c85c73f5': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '53f9aa07d73657d04951f9bbdd83fef8': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'NestedLoop_Outer_st1', 'NestedLoop_Outer_rt1', 'NestedLoop_Outer_st2', 'NestedLoop_Outer_rt2'],
    'f8295d8b477b477dfdc9391679ee0626': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'f4603221ed908983d5775a3734bacac0': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '5bfce15946616546d0be06b28c79e909': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'e1d7e5b4b64fa2791f32be783ffb6013': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '54cb7f90c390f02e0b015342853386d0': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '3d4c3db9a0977643bddc82d44c93492c': ['HashJoin_Outer_st1', 'HashJoin_Outer_rt1', 'HashJoin_Outer_st2', 'HashJoin_Outer_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'ef93d4fc6e5b9506d1cf51950a1c2be7': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'c302739ba5fe522ac572bfdbdd8c26e9': ['SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '9ce781b0006e0486de27d9cf912f5f3b': ['Hash_Inner_st1', 'Hash_Inner_rt1', 'Hash_Inner_st2', 'Hash_Inner_rt2', 'IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    '5ae97df8a6895acd1a7e15f6e5b6f95f': ['IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
    'a95bee4e9ae59bc7fb7a48a1a7973a31': ['IndexScan_Inner_st1', 'IndexScan_Inner_rt1', 'IndexScan_Inner_st2', 'IndexScan_Inner_rt2', 'SeqScan_Outer_st1', 'SeqScan_Outer_rt1', 'SeqScan_Outer_st2', 'SeqScan_Outer_rt2'],
}

# Target types for two-step feature selection
TARGET_TYPES = ['execution_time', 'start_time']

# Target type to column name mapping
TARGET_NAME_MAP = {
    'execution_time': 'actual_total_time',
    'start_time': 'actual_startup_time'
}

# Column suffixes to exclude from feature selection (structural metadata)
# These columns provide structural information but are not predictive features
NON_FEATURE_SUFFIXES = [
    '_node_id',
    '_node_type',
    '_depth',
    '_parent_relationship',
    '_subplan_name',
    '_actual_startup_time',
    '_actual_total_time'
]

# Forward Feature Selection configuration
FFS_SEED = 42
FFS_MIN_FEATURES = 1

# SVM hyperparameters for NuSVR models
SVM_PARAMS = {
    'kernel': 'rbf',
    'nu': 0.65,
    'C': 1.5,
    'gamma': 'scale',
    'cache_size': 500
}
