# Execution Plan: Q9_147_seed_1197788526

## Overview
- Total steps: 10
- Pattern-based steps: 6
- Operator-based steps: 4

## Execution Steps (Bottom-Up)

### Step 1

**Type:** Pattern Model
**Pattern:** Nested_Loop_Seq_Scan_Outer_Index_Scan_Inner
**Leaf Pattern:** Leaf

**Operators:**
- Nested Loop (depth 9)
- Seq Scan (depth 10)
- Index Scan (depth 10)

---

#### Nested Loop (Parent)

**Expected Features (execution_time model):**
- IndexScan_Inner_startup_cost
- NestedLoop_startup_cost

**Test Data Mapping (execution_time):**
- startup_cost (row depth 9) → NestedLoop_startup_cost
- IndexScan_Inner_startup_cost (from child operator)

**Expected Features (start_time model):**
- SeqScan_Outer_reltuples

**Test Data Mapping (start_time):**
- SeqScan_Outer_reltuples (from child operator)

#### Seq Scan (Child Outer)

**Expected Features (execution_time model):**

**Test Data Mapping (execution_time):**

**Expected Features (start_time model):**
- SeqScan_Outer_reltuples

**Test Data Mapping (start_time):**
- reltuples (row depth 10) → SeqScan_Outer_reltuples

#### Index Scan (Child Inner)

**Expected Features (execution_time model):**
- IndexScan_Inner_startup_cost

**Test Data Mapping (execution_time):**
- startup_cost (row depth 10) → IndexScan_Inner_startup_cost

**Expected Features (start_time model):**

**Test Data Mapping (start_time):**

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 8):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 2

**Type:** Pattern Model
**Pattern:** Hash_Seq_Scan_Outer
**Leaf Pattern:** Leaf

**Operators:**
- Hash (depth 9)
- Seq Scan (depth 10)

---

#### Hash (Parent)

**Expected Features (execution_time model):**
- Hash_nt
- Hash_nt1
- Hash_startup_cost
- SeqScan_Outer_nt

**Test Data Mapping (execution_time):**
- nt (row depth 9) → Hash_nt
- nt1 (row depth 9) → Hash_nt1
- startup_cost (row depth 9) → Hash_startup_cost
- SeqScan_Outer_nt (from child operator)

**Expected Features (start_time model):**
- Hash_nt
- Hash_nt1
- Hash_startup_cost
- SeqScan_Outer_nt

**Test Data Mapping (start_time):**
- nt (row depth 9) → Hash_nt
- nt1 (row depth 9) → Hash_nt1
- startup_cost (row depth 9) → Hash_startup_cost
- SeqScan_Outer_nt (from child operator)

#### Seq Scan (Child Outer)

**Expected Features (execution_time model):**
- SeqScan_Outer_nt

**Test Data Mapping (execution_time):**
- nt (row depth 10) → SeqScan_Outer_nt

**Expected Features (start_time model):**
- SeqScan_Outer_nt

**Test Data Mapping (start_time):**
- nt (row depth 10) → SeqScan_Outer_nt

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 8):**
- predicted_startup_time → st2
- predicted_total_time → rt2


### Step 3

**Type:** Pattern Model
**Pattern:** Hash_Seq_Scan_Outer
**Leaf Pattern:** Leaf

**Operators:**
- Hash (depth 8)
- Seq Scan (depth 9)

---

#### Hash (Parent)

**Expected Features (execution_time model):**
- Hash_nt
- Hash_nt1
- Hash_startup_cost
- SeqScan_Outer_nt

**Test Data Mapping (execution_time):**
- nt (row depth 8) → Hash_nt
- nt1 (row depth 8) → Hash_nt1
- startup_cost (row depth 8) → Hash_startup_cost
- SeqScan_Outer_nt (from child operator)

**Expected Features (start_time model):**
- Hash_nt
- Hash_nt1
- Hash_startup_cost
- SeqScan_Outer_nt

**Test Data Mapping (start_time):**
- nt (row depth 8) → Hash_nt
- nt1 (row depth 8) → Hash_nt1
- startup_cost (row depth 8) → Hash_startup_cost
- SeqScan_Outer_nt (from child operator)

#### Seq Scan (Child Outer)

**Expected Features (execution_time model):**
- SeqScan_Outer_nt

**Test Data Mapping (execution_time):**
- nt (row depth 9) → SeqScan_Outer_nt

**Expected Features (start_time model):**
- SeqScan_Outer_nt

**Test Data Mapping (start_time):**
- nt (row depth 9) → SeqScan_Outer_nt

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 7):**
- predicted_startup_time → st2
- predicted_total_time → rt2


### Step 4

**Type:** Operator Model
**Operator:** Hash Join
**Depth:** 8

**Children:**
- Nested Loop (depth 9)
- Hash (depth 9)

---

**Expected Features (execution_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- reltuples
- rt1
- rt2
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (execution_time):**
- np (row depth 8) → np
- nt (row depth 8) → nt
- nt1 (row depth 8) → nt1
- nt2 (row depth 8) → nt2
- parallel_workers (row depth 8) → parallel_workers
- reltuples (row depth 8) → reltuples
- startup_cost (row depth 8) → startup_cost
- total_cost (row depth 8) → total_cost

**Child Features from Predictions (execution_time):**
- Nested Loop (depth 9, Outer) predicted_total_time → rt1
- Nested Loop (depth 9, Outer) predicted_startup_time → st1
- Hash (depth 9, Inner) predicted_total_time → rt2
- Hash (depth 9, Inner) predicted_startup_time → st2

**Expected Features (start_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 8) → np
- nt (row depth 8) → nt
- nt1 (row depth 8) → nt1
- nt2 (row depth 8) → nt2
- parallel_workers (row depth 8) → parallel_workers
- plan_width (row depth 8) → plan_width
- reltuples (row depth 8) → reltuples
- sel (row depth 8) → sel
- total_cost (row depth 8) → total_cost

**Child Features from Predictions (start_time):**
- Nested Loop (depth 9, Outer) predicted_total_time → rt1
- Nested Loop (depth 9, Outer) predicted_startup_time → st1
- Hash (depth 9, Inner) predicted_total_time → rt2
- Hash (depth 9, Inner) predicted_startup_time → st2

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 7):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 5

**Type:** Pattern Model
**Pattern:** Hash_Hash_Join_Outer
**Leaf Pattern:** Non-Leaf

**Operators:**
- Hash (depth 6)
- Hash Join (depth 7)

---

#### Hash (Parent)

**Expected Features (execution_time model):**
- HashJoin_Outer_nt1
- HashJoin_Outer_rt1
- HashJoin_Outer_rt2
- HashJoin_Outer_st1
- HashJoin_Outer_st2

**Test Data Mapping (execution_time):**
- HashJoin_Outer_nt1 (from child operator)
- HashJoin_Outer_rt1 (from child operator)
- HashJoin_Outer_rt2 (from child operator)
- HashJoin_Outer_st1 (from child operator)
- HashJoin_Outer_st2 (from child operator)

**Expected Features (start_time model):**
- HashJoin_Outer_nt1
- HashJoin_Outer_rt1
- HashJoin_Outer_rt2
- HashJoin_Outer_st1
- HashJoin_Outer_st2

**Test Data Mapping (start_time):**
- HashJoin_Outer_nt1 (from child operator)
- HashJoin_Outer_rt1 (from child operator)
- HashJoin_Outer_rt2 (from child operator)
- HashJoin_Outer_st1 (from child operator)
- HashJoin_Outer_st2 (from child operator)

**Child Features Needed:**
- HashJoin_Outer_st1

#### Hash Join (Child Outer)

**Expected Features (execution_time model):**
- HashJoin_Outer_nt1
- HashJoin_Outer_rt1
- HashJoin_Outer_rt2
- HashJoin_Outer_st1
- HashJoin_Outer_st2

**Test Data Mapping (execution_time):**
- nt1 (row depth 7) → HashJoin_Outer_nt1
- rt1 (row depth 7) → HashJoin_Outer_rt1
- rt2 (row depth 7) → HashJoin_Outer_rt2
- st1 (row depth 7) → HashJoin_Outer_st1
- st2 (row depth 7) → HashJoin_Outer_st2

**Expected Features (start_time model):**
- HashJoin_Outer_nt1
- HashJoin_Outer_rt1
- HashJoin_Outer_rt2
- HashJoin_Outer_st1
- HashJoin_Outer_st2

**Test Data Mapping (start_time):**
- nt1 (row depth 7) → HashJoin_Outer_nt1
- rt1 (row depth 7) → HashJoin_Outer_rt1
- rt2 (row depth 7) → HashJoin_Outer_rt2
- st1 (row depth 7) → HashJoin_Outer_st1
- st2 (row depth 7) → HashJoin_Outer_st2

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 5):**
- predicted_startup_time → st2
- predicted_total_time → rt2


### Step 6

**Type:** Operator Model
**Operator:** Seq Scan
**Depth:** 6

---

**Expected Features (execution_time model):**
- np
- plan_width
- sel

**Test Data Mapping (execution_time):**
- np (row depth 6) → np
- plan_width (row depth 6) → plan_width
- sel (row depth 6) → sel

**Expected Features (start_time model):**
- np
- plan_width
- reltuples
- sel
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 6) → np
- plan_width (row depth 6) → plan_width
- reltuples (row depth 6) → reltuples
- sel (row depth 6) → sel
- total_cost (row depth 6) → total_cost

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 5):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 7

**Type:** Pattern Model
**Pattern:** Nested_Loop_Hash_Join_Outer_Index_Scan_Inner
**Leaf Pattern:** Non-Leaf

**Operators:**
- Nested Loop (depth 4)
- Hash Join (depth 5)
- Index Scan (depth 5)

---

#### Nested Loop (Parent)

**Expected Features (execution_time model):**
- HashJoin_Outer_rt1
- HashJoin_Outer_rt2
- HashJoin_Outer_st1
- HashJoin_Outer_st2
- IndexScan_Inner_total_cost
- NestedLoop_nt1

**Test Data Mapping (execution_time):**
- nt1 (row depth 4) → NestedLoop_nt1
- HashJoin_Outer_rt1 (from child operator)
- HashJoin_Outer_rt2 (from child operator)
- HashJoin_Outer_st1 (from child operator)
- HashJoin_Outer_st2 (from child operator)
- IndexScan_Inner_total_cost (from child operator)

**Expected Features (start_time model):**
- HashJoin_Outer_rt1
- HashJoin_Outer_rt2
- HashJoin_Outer_st1
- HashJoin_Outer_st2
- HashJoin_Outer_total_cost

**Test Data Mapping (start_time):**
- HashJoin_Outer_rt1 (from child operator)
- HashJoin_Outer_rt2 (from child operator)
- HashJoin_Outer_st1 (from child operator)
- HashJoin_Outer_st2 (from child operator)
- HashJoin_Outer_total_cost (from child operator)

**Child Features Needed:**
- HashJoin_Outer_rt1
- HashJoin_Outer_rt2
- HashJoin_Outer_st1
- HashJoin_Outer_st2

#### Hash Join (Child Outer)

**Expected Features (execution_time model):**
- HashJoin_Outer_rt1
- HashJoin_Outer_rt2
- HashJoin_Outer_st1
- HashJoin_Outer_st2

**Test Data Mapping (execution_time):**
- rt1 (row depth 5) → HashJoin_Outer_rt1
- rt2 (row depth 5) → HashJoin_Outer_rt2
- st1 (row depth 5) → HashJoin_Outer_st1
- st2 (row depth 5) → HashJoin_Outer_st2

**Expected Features (start_time model):**
- HashJoin_Outer_rt1
- HashJoin_Outer_rt2
- HashJoin_Outer_st1
- HashJoin_Outer_st2
- HashJoin_Outer_total_cost

**Test Data Mapping (start_time):**
- rt1 (row depth 5) → HashJoin_Outer_rt1
- rt2 (row depth 5) → HashJoin_Outer_rt2
- st1 (row depth 5) → HashJoin_Outer_st1
- st2 (row depth 5) → HashJoin_Outer_st2
- total_cost (row depth 5) → HashJoin_Outer_total_cost

#### Index Scan (Child Inner)

**Expected Features (execution_time model):**
- IndexScan_Inner_total_cost

**Test Data Mapping (execution_time):**
- total_cost (row depth 5) → IndexScan_Inner_total_cost

**Expected Features (start_time model):**

**Test Data Mapping (start_time):**

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 3):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 8

**Type:** Pattern Model
**Pattern:** Gather_Aggregate_Outer
**Leaf Pattern:** Non-Leaf

**Operators:**
- Gather (depth 2)
- Aggregate (depth 3)

---

#### Gather (Parent)

**Expected Features (execution_time model):**
- Aggregate_Outer_rt1
- Aggregate_Outer_rt2
- Aggregate_Outer_st1
- Aggregate_Outer_st2

**Test Data Mapping (execution_time):**
- Aggregate_Outer_rt1 (from child operator)
- Aggregate_Outer_rt2 (from child operator)
- Aggregate_Outer_st1 (from child operator)
- Aggregate_Outer_st2 (from child operator)

**Expected Features (start_time model):**
- Aggregate_Outer_rt1
- Aggregate_Outer_rt2
- Aggregate_Outer_st1
- Aggregate_Outer_st2

**Test Data Mapping (start_time):**
- Aggregate_Outer_rt1 (from child operator)
- Aggregate_Outer_rt2 (from child operator)
- Aggregate_Outer_st1 (from child operator)
- Aggregate_Outer_st2 (from child operator)

**Child Features Needed:**
- Aggregate_Outer_rt2
- Aggregate_Outer_st1
- Aggregate_Outer_st2

#### Aggregate (Child Outer)

**Expected Features (execution_time model):**
- Aggregate_Outer_rt1
- Aggregate_Outer_rt2
- Aggregate_Outer_st1
- Aggregate_Outer_st2

**Test Data Mapping (execution_time):**
- rt1 (row depth 3) → Aggregate_Outer_rt1
- rt2 (row depth 3) → Aggregate_Outer_rt2
- st1 (row depth 3) → Aggregate_Outer_st1
- st2 (row depth 3) → Aggregate_Outer_st2

**Expected Features (start_time model):**
- Aggregate_Outer_rt1
- Aggregate_Outer_rt2
- Aggregate_Outer_st1
- Aggregate_Outer_st2

**Test Data Mapping (start_time):**
- rt1 (row depth 3) → Aggregate_Outer_rt1
- rt2 (row depth 3) → Aggregate_Outer_rt2
- st1 (row depth 3) → Aggregate_Outer_st1
- st2 (row depth 3) → Aggregate_Outer_st2

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 1):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 9

**Type:** Operator Model
**Operator:** Aggregate
**Depth:** 1

**Children:**
- Gather (depth 2)

---

**Expected Features (execution_time model):**
- np
- nt1
- nt2
- parallel_workers
- reltuples
- rt1
- rt2
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (execution_time):**
- np (row depth 1) → np
- nt1 (row depth 1) → nt1
- nt2 (row depth 1) → nt2
- parallel_workers (row depth 1) → parallel_workers
- reltuples (row depth 1) → reltuples
- startup_cost (row depth 1) → startup_cost
- total_cost (row depth 1) → total_cost

**Child Features from Predictions (execution_time):**
- Gather (depth 2, Outer) predicted_total_time → rt1
- Gather (depth 2, Outer) predicted_startup_time → st1

**Expected Features (start_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 1) → np
- nt (row depth 1) → nt
- nt1 (row depth 1) → nt1
- nt2 (row depth 1) → nt2
- parallel_workers (row depth 1) → parallel_workers
- plan_width (row depth 1) → plan_width
- reltuples (row depth 1) → reltuples
- sel (row depth 1) → sel
- startup_cost (row depth 1) → startup_cost
- total_cost (row depth 1) → total_cost

**Child Features from Predictions (start_time):**
- Gather (depth 2, Outer) predicted_total_time → rt1
- Gather (depth 2, Outer) predicted_startup_time → st1

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 0):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 10

**Type:** Operator Model
**Operator:** Sort
**Depth:** 0

**Children:**
- Aggregate (depth 1)

---

**Expected Features (execution_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (execution_time):**
- np (row depth 0) → np
- nt (row depth 0) → nt
- nt1 (row depth 0) → nt1
- nt2 (row depth 0) → nt2
- parallel_workers (row depth 0) → parallel_workers
- plan_width (row depth 0) → plan_width
- reltuples (row depth 0) → reltuples
- sel (row depth 0) → sel
- startup_cost (row depth 0) → startup_cost
- total_cost (row depth 0) → total_cost

**Child Features from Predictions (execution_time):**
- Aggregate (depth 1, Outer) predicted_total_time → rt1
- Aggregate (depth 1, Outer) predicted_startup_time → st1

**Expected Features (start_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 0) → np
- nt (row depth 0) → nt
- nt1 (row depth 0) → nt1
- nt2 (row depth 0) → nt2
- parallel_workers (row depth 0) → parallel_workers
- plan_width (row depth 0) → plan_width
- reltuples (row depth 0) → reltuples
- sel (row depth 0) → sel
- startup_cost (row depth 0) → startup_cost
- total_cost (row depth 0) → total_cost

**Child Features from Predictions (start_time):**
- Aggregate (depth 1, Outer) predicted_total_time → rt1
- Aggregate (depth 1, Outer) predicted_startup_time → st1

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

