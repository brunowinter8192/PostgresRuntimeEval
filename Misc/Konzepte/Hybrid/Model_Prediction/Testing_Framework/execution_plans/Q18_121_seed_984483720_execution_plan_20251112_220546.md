# Execution Plan: Q18_121_seed_984483720

## Overview
- Total steps: 11
- Pattern-based steps: 4
- Operator-based steps: 7

## Execution Steps (Bottom-Up)

### Step 1

**Type:** Operator Model
**Operator:** Index Scan
**Depth:** 11

---

**Expected Features (execution_time model):**
- plan_width
- startup_cost

**Test Data Mapping (execution_time):**
- plan_width (row depth 11) → plan_width
- startup_cost (row depth 11) → startup_cost

**Expected Features (start_time model):**
- plan_width
- reltuples
- sel

**Test Data Mapping (start_time):**
- plan_width (row depth 11) → plan_width
- reltuples (row depth 11) → reltuples
- sel (row depth 11) → sel

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 10):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 2

**Type:** Pattern Model
**Pattern:** Hash_Aggregate_Outer
**Leaf Pattern:** Non-Leaf

**Operators:**
- Hash (depth 9)
- Aggregate (depth 10)

---

**Expected Features (execution_time model):**
- Aggregate_Outer_rt1 = 0.0
- Aggregate_Outer_rt2 = 0.0
- Aggregate_Outer_st1 = 0.0
- Aggregate_Outer_st2 = 0.0
- Hash_nt = 407734

**Feature Aggregation (execution_time):**
- rt1 (row depth 10, Aggregate Outer) = 0.0 → Aggregate_Outer_rt1
- rt2 (row depth 10, Aggregate Outer) = 0.0 → Aggregate_Outer_rt2
- st1 (row depth 10, Aggregate Outer) = 0.0 → Aggregate_Outer_st1
- st2 (row depth 10, Aggregate Outer) = 0.0 → Aggregate_Outer_st2
- nt (row depth 9, Hash) = 407734 → Hash_nt

**Expected Features (start_time model):**
- Aggregate_Outer_rt1 = 0.0
- Aggregate_Outer_rt2 = 0.0
- Aggregate_Outer_st1 = 0.0
- Aggregate_Outer_st2 = 0.0
- Hash_nt = 407734

**Feature Aggregation (start_time):**
- rt1 (row depth 10, Aggregate Outer) = 0.0 → Aggregate_Outer_rt1
- rt2 (row depth 10, Aggregate Outer) = 0.0 → Aggregate_Outer_rt2
- st1 (row depth 10, Aggregate Outer) = 0.0 → Aggregate_Outer_st1
- st2 (row depth 10, Aggregate Outer) = 0.0 → Aggregate_Outer_st2
- nt (row depth 9, Hash) = 407734 → Hash_nt

**Child Features Needed (from predictions):**
- Aggregate_Outer_rt2 = 0.0
- Aggregate_Outer_st1 = 0.0
- Aggregate_Outer_st2 = 0.0

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 8):**
- predicted_startup_time → st2
- predicted_total_time → rt2


### Step 3

**Type:** Operator Model
**Operator:** Seq Scan
**Depth:** 9

---

**Expected Features (execution_time model):**
- np
- plan_width
- sel

**Test Data Mapping (execution_time):**
- np (row depth 9) → np
- plan_width (row depth 9) → plan_width
- sel (row depth 9) → sel

**Expected Features (start_time model):**
- np
- plan_width
- reltuples
- sel
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 9) → np
- plan_width (row depth 9) → plan_width
- reltuples (row depth 9) → reltuples
- sel (row depth 9) → sel
- total_cost (row depth 9) → total_cost

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 8):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 4

**Type:** Pattern Model
**Pattern:** Sort_Hash_Join_Outer
**Leaf Pattern:** Non-Leaf

**Operators:**
- Sort (depth 7)
- Hash Join (depth 8)

---

**Expected Features (execution_time model):**
- HashJoin_Outer_rt1 = 0.0
- HashJoin_Outer_rt2 = 0.0
- HashJoin_Outer_st1 = 0.0
- HashJoin_Outer_st2 = 0.0

**Feature Aggregation (execution_time):**
- rt1 (row depth 8, Hash Join Outer) = 0.0 → HashJoin_Outer_rt1
- rt2 (row depth 8, Hash Join Outer) = 0.0 → HashJoin_Outer_rt2
- st1 (row depth 8, Hash Join Outer) = 0.0 → HashJoin_Outer_st1
- st2 (row depth 8, Hash Join Outer) = 0.0 → HashJoin_Outer_st2

**Expected Features (start_time model):**
- HashJoin_Outer_rt1 = 0.0
- HashJoin_Outer_rt2 = 0.0
- HashJoin_Outer_st1 = 0.0
- HashJoin_Outer_st2 = 0.0

**Feature Aggregation (start_time):**
- rt1 (row depth 8, Hash Join Outer) = 0.0 → HashJoin_Outer_rt1
- rt2 (row depth 8, Hash Join Outer) = 0.0 → HashJoin_Outer_rt2
- st1 (row depth 8, Hash Join Outer) = 0.0 → HashJoin_Outer_st1
- st2 (row depth 8, Hash Join Outer) = 0.0 → HashJoin_Outer_st2

**Child Features Needed (from predictions):**
- HashJoin_Outer_rt2 = 0.0
- HashJoin_Outer_st1 = 0.0
- HashJoin_Outer_st2 = 0.0

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 6):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 5

**Type:** Pattern Model
**Pattern:** Sort_Seq_Scan_Outer
**Leaf Pattern:** Leaf

**Operators:**
- Sort (depth 7)
- Seq Scan (depth 8)

---

**Expected Features (execution_time model):**
- SeqScan_Outer_np = 3600
- SeqScan_Outer_nt = 150000
- SeqScan_Outer_nt1 = 0
- SeqScan_Outer_nt2 = 0
- SeqScan_Outer_parallel_workers = 0
- SeqScan_Outer_plan_width = 23
- SeqScan_Outer_reltuples = 150000.0
- SeqScan_Outer_sel = 1.0
- SeqScan_Outer_startup_cost = 0.0
- SeqScan_Outer_total_cost = 5100.0
- Sort_np = 0
- Sort_nt = 150000
- Sort_nt1 = 150000
- Sort_nt2 = 0
- Sort_parallel_workers = 0
- Sort_plan_width = 23
- Sort_reltuples = 0.0
- Sort_sel = 1.0
- Sort_startup_cost = 17995.95
- Sort_total_cost = 18370.95

**Feature Aggregation (execution_time):**
- np (row depth 8, Seq Scan Outer) = 3600 → SeqScan_Outer_np
- nt (row depth 8, Seq Scan Outer) = 150000 → SeqScan_Outer_nt
- nt1 (row depth 8, Seq Scan Outer) = 0 → SeqScan_Outer_nt1
- nt2 (row depth 8, Seq Scan Outer) = 0 → SeqScan_Outer_nt2
- parallel_workers (row depth 8, Seq Scan Outer) = 0 → SeqScan_Outer_parallel_workers
- plan_width (row depth 8, Seq Scan Outer) = 23 → SeqScan_Outer_plan_width
- reltuples (row depth 8, Seq Scan Outer) = 150000.0 → SeqScan_Outer_reltuples
- sel (row depth 8, Seq Scan Outer) = 1.0 → SeqScan_Outer_sel
- startup_cost (row depth 8, Seq Scan Outer) = 0.0 → SeqScan_Outer_startup_cost
- total_cost (row depth 8, Seq Scan Outer) = 5100.0 → SeqScan_Outer_total_cost
- np (row depth 7, Sort) = 0 → Sort_np
- nt (row depth 7, Sort) = 150000 → Sort_nt
- nt1 (row depth 7, Sort) = 150000 → Sort_nt1
- nt2 (row depth 7, Sort) = 0 → Sort_nt2
- parallel_workers (row depth 7, Sort) = 0 → Sort_parallel_workers
- plan_width (row depth 7, Sort) = 23 → Sort_plan_width
- reltuples (row depth 7, Sort) = 0.0 → Sort_reltuples
- sel (row depth 7, Sort) = 1.0 → Sort_sel
- startup_cost (row depth 7, Sort) = 17995.95 → Sort_startup_cost
- total_cost (row depth 7, Sort) = 18370.95 → Sort_total_cost

**Expected Features (start_time model):**
- SeqScan_Outer_np = 3600
- SeqScan_Outer_nt = 150000
- SeqScan_Outer_nt1 = 0
- SeqScan_Outer_nt2 = 0
- SeqScan_Outer_parallel_workers = 0
- SeqScan_Outer_plan_width = 23
- SeqScan_Outer_reltuples = 150000.0
- SeqScan_Outer_sel = 1.0
- SeqScan_Outer_startup_cost = 0.0
- SeqScan_Outer_total_cost = 5100.0
- Sort_np = 0
- Sort_nt = 150000
- Sort_nt1 = 150000
- Sort_nt2 = 0
- Sort_parallel_workers = 0
- Sort_plan_width = 23
- Sort_reltuples = 0.0
- Sort_sel = 1.0
- Sort_startup_cost = 17995.95
- Sort_total_cost = 18370.95

**Feature Aggregation (start_time):**
- np (row depth 8, Seq Scan Outer) = 3600 → SeqScan_Outer_np
- nt (row depth 8, Seq Scan Outer) = 150000 → SeqScan_Outer_nt
- nt1 (row depth 8, Seq Scan Outer) = 0 → SeqScan_Outer_nt1
- nt2 (row depth 8, Seq Scan Outer) = 0 → SeqScan_Outer_nt2
- parallel_workers (row depth 8, Seq Scan Outer) = 0 → SeqScan_Outer_parallel_workers
- plan_width (row depth 8, Seq Scan Outer) = 23 → SeqScan_Outer_plan_width
- reltuples (row depth 8, Seq Scan Outer) = 150000.0 → SeqScan_Outer_reltuples
- sel (row depth 8, Seq Scan Outer) = 1.0 → SeqScan_Outer_sel
- startup_cost (row depth 8, Seq Scan Outer) = 0.0 → SeqScan_Outer_startup_cost
- total_cost (row depth 8, Seq Scan Outer) = 5100.0 → SeqScan_Outer_total_cost
- np (row depth 7, Sort) = 0 → Sort_np
- nt (row depth 7, Sort) = 150000 → Sort_nt
- nt1 (row depth 7, Sort) = 150000 → Sort_nt1
- nt2 (row depth 7, Sort) = 0 → Sort_nt2
- parallel_workers (row depth 7, Sort) = 0 → Sort_parallel_workers
- plan_width (row depth 7, Sort) = 23 → Sort_plan_width
- reltuples (row depth 7, Sort) = 0.0 → Sort_reltuples
- sel (row depth 7, Sort) = 1.0 → Sort_sel
- startup_cost (row depth 7, Sort) = 17995.95 → Sort_startup_cost
- total_cost (row depth 7, Sort) = 18370.95 → Sort_total_cost

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 6):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 6

**Type:** Pattern Model
**Pattern:** Nested_Loop_Merge_Join_Outer_Index_Scan_Inner
**Leaf Pattern:** Non-Leaf

**Operators:**
- Nested Loop (depth 5)
- Merge Join (depth 6)
- Index Scan (depth 6)

---

**Expected Features (execution_time model):**
- MergeJoin_Outer_rt1 = 0.0
- MergeJoin_Outer_rt2 = 0.0
- MergeJoin_Outer_st1 = 0.0
- MergeJoin_Outer_st2 = 0.0
- NestedLoop_nt = 526215

**Feature Aggregation (execution_time):**
- rt1 (row depth 6, Merge Join Outer) = 0.0 → MergeJoin_Outer_rt1
- rt2 (row depth 6, Merge Join Outer) = 0.0 → MergeJoin_Outer_rt2
- st1 (row depth 6, Merge Join Outer) = 0.0 → MergeJoin_Outer_st1
- st2 (row depth 6, Merge Join Outer) = 0.0 → MergeJoin_Outer_st2
- nt (row depth 5, Nested Loop) = 526215 → NestedLoop_nt

**Expected Features (start_time model):**
- MergeJoin_Outer_rt1 = 0.0
- MergeJoin_Outer_rt2 = 0.0
- MergeJoin_Outer_st1 = 0.0
- MergeJoin_Outer_st2 = 0.0
- NestedLoop_nt = 526215

**Feature Aggregation (start_time):**
- rt1 (row depth 6, Merge Join Outer) = 0.0 → MergeJoin_Outer_rt1
- rt2 (row depth 6, Merge Join Outer) = 0.0 → MergeJoin_Outer_rt2
- st1 (row depth 6, Merge Join Outer) = 0.0 → MergeJoin_Outer_st1
- st2 (row depth 6, Merge Join Outer) = 0.0 → MergeJoin_Outer_st2
- nt (row depth 5, Nested Loop) = 526215 → NestedLoop_nt

**Child Features Needed (from predictions):**
- MergeJoin_Outer_rt2 = 0.0
- MergeJoin_Outer_st2 = 0.0

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 4):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 7

**Type:** Operator Model
**Operator:** Incremental Sort
**Depth:** 4

**Children:**
- Nested Loop (depth 5)

---

**Expected Features (execution_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (execution_time):**
- np (row depth 4) → np
- nt (row depth 4) → nt
- nt1 (row depth 4) → nt1
- nt2 (row depth 4) → nt2
- parallel_workers (row depth 4) → parallel_workers
- plan_width (row depth 4) → plan_width
- reltuples (row depth 4) → reltuples
- sel (row depth 4) → sel
- startup_cost (row depth 4) → startup_cost
- total_cost (row depth 4) → total_cost

**Child Features from Predictions (execution_time):**
- Nested Loop (depth 5, Outer) predicted_total_time → rt1
- Nested Loop (depth 5, Outer) predicted_startup_time → st1

**Expected Features (start_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 4) → np
- nt (row depth 4) → nt
- nt1 (row depth 4) → nt1
- nt2 (row depth 4) → nt2
- parallel_workers (row depth 4) → parallel_workers
- plan_width (row depth 4) → plan_width
- reltuples (row depth 4) → reltuples
- sel (row depth 4) → sel
- startup_cost (row depth 4) → startup_cost
- total_cost (row depth 4) → total_cost

**Child Features from Predictions (start_time):**
- Nested Loop (depth 5, Outer) predicted_total_time → rt1
- Nested Loop (depth 5, Outer) predicted_startup_time → st1

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 3):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 8

**Type:** Operator Model
**Operator:** Gather Merge
**Depth:** 3

**Children:**
- Incremental Sort (depth 4)

---

**Expected Features (execution_time model):**
- np
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (execution_time):**
- np (row depth 3) → np
- nt1 (row depth 3) → nt1
- nt2 (row depth 3) → nt2
- parallel_workers (row depth 3) → parallel_workers
- plan_width (row depth 3) → plan_width
- reltuples (row depth 3) → reltuples
- sel (row depth 3) → sel
- startup_cost (row depth 3) → startup_cost
- total_cost (row depth 3) → total_cost

**Child Features from Predictions (execution_time):**
- Incremental Sort (depth 4, Outer) predicted_total_time → rt1
- Incremental Sort (depth 4, Outer) predicted_startup_time → st1

**Expected Features (start_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 3) → np
- nt (row depth 3) → nt
- nt1 (row depth 3) → nt1
- nt2 (row depth 3) → nt2
- parallel_workers (row depth 3) → parallel_workers
- plan_width (row depth 3) → plan_width
- reltuples (row depth 3) → reltuples
- sel (row depth 3) → sel
- startup_cost (row depth 3) → startup_cost
- total_cost (row depth 3) → total_cost

**Child Features from Predictions (start_time):**
- Incremental Sort (depth 4, Outer) predicted_total_time → rt1
- Incremental Sort (depth 4, Outer) predicted_startup_time → st1

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 2):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 9

**Type:** Operator Model
**Operator:** Aggregate
**Depth:** 2

**Children:**
- Gather Merge (depth 3)

---

**Expected Features (execution_time model):**
- np
- nt1
- nt2
- parallel_workers
- reltuples
- rt1
- rt2
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (execution_time):**
- np (row depth 2) → np
- nt1 (row depth 2) → nt1
- nt2 (row depth 2) → nt2
- parallel_workers (row depth 2) → parallel_workers
- reltuples (row depth 2) → reltuples
- startup_cost (row depth 2) → startup_cost
- total_cost (row depth 2) → total_cost

**Child Features from Predictions (execution_time):**
- Gather Merge (depth 3, Outer) predicted_total_time → rt1
- Gather Merge (depth 3, Outer) predicted_startup_time → st1

**Expected Features (start_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 2) → np
- nt (row depth 2) → nt
- nt1 (row depth 2) → nt1
- nt2 (row depth 2) → nt2
- parallel_workers (row depth 2) → parallel_workers
- plan_width (row depth 2) → plan_width
- reltuples (row depth 2) → reltuples
- sel (row depth 2) → sel
- startup_cost (row depth 2) → startup_cost
- total_cost (row depth 2) → total_cost

**Child Features from Predictions (start_time):**
- Gather Merge (depth 3, Outer) predicted_total_time → rt1
- Gather Merge (depth 3, Outer) predicted_startup_time → st1

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 1):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 10

**Type:** Operator Model
**Operator:** Sort
**Depth:** 1

**Children:**
- Aggregate (depth 2)

---

**Expected Features (execution_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (execution_time):**
- np (row depth 1) → np
- nt (row depth 1) → nt
- nt1 (row depth 1) → nt1
- nt2 (row depth 1) → nt2
- parallel_workers (row depth 1) → parallel_workers
- plan_width (row depth 1) → plan_width
- reltuples (row depth 1) → reltuples
- sel (row depth 1) → sel
- startup_cost (row depth 1) → startup_cost
- total_cost (row depth 1) → total_cost

**Child Features from Predictions (execution_time):**
- Aggregate (depth 2, Outer) predicted_total_time → rt1
- Aggregate (depth 2, Outer) predicted_startup_time → st1

**Expected Features (start_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- plan_width
- reltuples
- rt1
- rt2
- sel
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 1) → np
- nt (row depth 1) → nt
- nt1 (row depth 1) → nt1
- nt2 (row depth 1) → nt2
- parallel_workers (row depth 1) → parallel_workers
- plan_width (row depth 1) → plan_width
- reltuples (row depth 1) → reltuples
- sel (row depth 1) → sel
- startup_cost (row depth 1) → startup_cost
- total_cost (row depth 1) → total_cost

**Child Features from Predictions (start_time):**
- Aggregate (depth 2, Outer) predicted_total_time → rt1
- Aggregate (depth 2, Outer) predicted_startup_time → st1

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

**Targets to Features (for parent operator at depth 0):**
- predicted_startup_time → st1
- predicted_total_time → rt1


### Step 11

**Type:** Operator Model
**Operator:** Limit
**Depth:** 0

**Children:**
- Sort (depth 1)

---

**Expected Features (execution_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- reltuples
- rt1
- rt2
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (execution_time):**
- np (row depth 0) → np
- nt (row depth 0) → nt
- nt1 (row depth 0) → nt1
- nt2 (row depth 0) → nt2
- parallel_workers (row depth 0) → parallel_workers
- reltuples (row depth 0) → reltuples
- startup_cost (row depth 0) → startup_cost
- total_cost (row depth 0) → total_cost

**Child Features from Predictions (execution_time):**
- Sort (depth 1, Outer) predicted_total_time → rt1
- Sort (depth 1, Outer) predicted_startup_time → st1

**Expected Features (start_time model):**
- np
- nt
- nt1
- nt2
- parallel_workers
- reltuples
- rt1
- rt2
- st1
- st2
- startup_cost
- total_cost

**Test Data Mapping (start_time):**
- np (row depth 0) → np
- nt (row depth 0) → nt
- nt1 (row depth 0) → nt1
- nt2 (row depth 0) → nt2
- parallel_workers (row depth 0) → parallel_workers
- reltuples (row depth 0) → reltuples
- startup_cost (row depth 0) → startup_cost
- total_cost (row depth 0) → total_cost

**Child Features from Predictions (start_time):**
- Sort (depth 1, Outer) predicted_total_time → rt1
- Sort (depth 1, Outer) predicted_startup_time → st1

---

**Emitted Targets:**
- execution_time model → predicted_total_time
- start_time model → predicted_startup_time

